CREATE TABLE ACTOR (
ACT_ID NUMBER (3),
ACT_NAME VARCHAR (20),
ACT_GENDER CHAR (1),
PRIMARY KEY (ACT_ID));

             
CREATE TABLE DIRECTOR (
DIR_ID NUMBER (3),
DIR_NAME VARCHAR (20),
DIR_PHONE NUMBER (10),
PRIMARY KEY (DIR_ID));

CREATE TABLE MOVIES (
MOV_ID INT(4),
MOV_TITLE VARCHAR (25),
MOV_YEAR INT(4),
MOV_LANG VARCHAR (12),
DIR_ID NUMBER (3),
PRIMARY KEY (MOV_ID),
FOREIGN KEY (DIR_ID) REFERENCES DIRECTOR (DIR_ID));

desc movies;

                                          
CREATE TABLE MOVIE_CAST (
ACT_ID INT(3),
MOV_ID INT(4),
ROLE  VARCHAR (10),
PRIMARY KEY (ACT_ID, MOV_ID),
FOREIGN KEY (ACT_ID) REFERENCES ACTOR (ACT_ID),
FOREIGN KEY (MOV_ID) REFERENCES MOVIES (MOV_ID));

desc movie_cast;

CREATE TABLE RATING (
MOV_ID INT(5);
REV_STARS INT(5);
FOREIGN KEY (MOV_ID REFERENCES MOVIES(MOV_ID));

INSERT INTO ACTOR VALUES(130,'DEPP','M');
INSERT INTO ACTOR VALUES(131,'PITT','M');
INSERT INTO ACTOR VALUES(132,'PORTMAN','F');
INSERT INTO ACTOR VALUES(133,'HEMSWORTH','M');
INSERT INTO ACTOR VALUES(134,'OLSEN','F');
SELECT  FROM ACTOR;

INSERT INTO DIRECTOR VALUES(121,'COEN BROTHERS',1456652);
INSERT INTO DIRECTOR VALUES(122,'TARANTINO',7834652);
INSERT INTO DIRECTOR VALUES(123,'SPIELBERG',9034652);
INSERT INTO DIRECTOR VALUES(124,'KUBRICK',1780652);
INSERT INTO DIRECTOR VALUES(125,'PHILIPS',1234456);

SELECT  FROM DIRECTOR;

INSERT INTO MOVIES VALUES (1001,'LONE RANGER', 2017,'ENGLISH', 60);
INSERT INTO MOVIES VALUES (1002,'FURY', 2015,'ENGLISH', 60);
INSERT INTO MOVIES VALUES (1003,'AVENGERS', 2008,'ENGLISH', 61);
INSERT INTO MOVIES VALUES (1004,'GODFATHER', 2011,'ENGLISH', 63);

INSERT INTO MOVIE_CAST VALUES (130, 1002,'LEAD');
INSERT INTO MOVIE_CAST VALUES (131, 1001,'SUPPORT');
INSERT INTO MOVIE_CAST VALUES (132, 1003,'LEAD');
INSERT INTO MOVIE_CAST VALUES (133, 1002,'ANTAGONIST');
INSERT INTO MOVIE_CAST VALUES (134, 1004,'LEAD');


INSERT INTO RATING VALUES (1001, 4);
INSERT INTO RATING VALUES (1002, 2);
INSERT INTO RATING VALUES (1003, 5);
INSERT INTO RATING VALUES (1004, 4);

COMMIT;


SELECT MOV_TITLE
FROM MOVIES
WHERE DIR_ID IN (SELECT DIR_ID
FROM DIRECTOR
WHERE DIR_NAME = =HITCHCOCK‘);

SELECT MOV_TITLE
FROM MOVIES M, MOVIE_CAST MV
WHERE M.MOV_ID=MV.MOV_ID AND ACT_ID IN (SELECT ACT_ID
FROM MOVIE_CAST GROUP BY ACT_ID
HAVING COUNT (ACT_ID)1)
GROUP BY MOV_TITLE
HAVING COUNT ()1;

SELECT ACT_NAME, MOV_TITLE, MOV_YEAR
FROM ACTOR A
JOIN MOVIE_CAST C
ON A.ACT_ID=C.ACT_ID
JOIN MOVIES M
ON C.MOV_ID=M.MOV_ID
WHERE M.MOV_YEAR NOT BETWEEN 2000 AND 2015;
                                        
                                        
SELECT A.ACT_NAME, A.ACT_NAME, C.MOV_TITLE, C.MOV_YEAR
FROM ACTOR A, MOVIE_CAST B, MOVIES C
WHERE A.ACT_ID=B.ACT_ID
AND B.MOV_ID=C.MOV_ID
AND C.MOV_YEAR NOT BETWEEN 2000 AND 2015; 

SELECT MOV_TITLE, MAX (REV_STARS)
FROM MOVIES
INNER JOIN RATING USING (MOV_ID)
GROUP BY MOV_TITLE
HAVING MAX (REV_STARS)0
ORDER BY MOV_TITLE; 

UPDATE RATING
SET REV_STARS=5
WHERE MOV_ID IN (SELECT MOV_ID FROM MOVIES
WHERE DIR_ID IN (SELECT DIR_ID
FROM DIRECTOR
WHERE DIR_NAME = =STEVEN
SPIELBERG‘));
